; Simple test for division distribution
(include "staged_core_math.egg")

; Test the distribution rule: (a + b) / c â†’ a/c + b/c
(let test_expr (Div (Add (Mul (Var 0) (Var 0)) (Mul (Num 2.0) (Var 0))) (Var 0)))

; Run optimization
(run-schedule 
  (seq
    (saturate stage1_partitioning)
    (saturate stage2_constants) 
    (saturate stage3_summation)
    (saturate stage4_simplify)
    (saturate stage2_constants)
  ))

; Check if it equals what we expect: x + 2
(let expected (Add (Var 0) (Num 2.0)))
(check (= test_expr expected)) 